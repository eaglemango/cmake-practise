# Семинарское задание 4 (Continious Integration)
# Выполнил: Горбунов Сергей


## Основная информация

В качестве системы для Continious Integration был выбран `Travis CI`, поскольку наша команда (по созданию игры) использует `GitHub`, а `Travis` поддерживает его без каких-либо лишних телодвижений.

Файл конфигурации называется `.travis.yml`, лежит он в корне ветки.

Конфигурационный файл нашего проекта можно посмотреть [здесь](https://github.com/ficrus/battle-for-indent/blob/dev/.travis.yml). В процессе разработки он претерпел множество измениний (о причинах которых сказано ниже). На момент написания этого текста, конфиг выглядит так:

1. Указываем используемый язык и его версию

```
language: python

python:
  - "3.6"
```

2. Устанавливаем свежие версии Python модулей, требуемых для работоспособности игры

```
install:
  - pip install --upgrade pytest
  - pip install -r requirements.txt
```
3. Производим настройку виртуальной машины

```
before_script:
  - sudo apt-get update
  - sudo apt-get install build-essential
  - sudo apt-get install freeglut3-dev
  - "Xvfb :1 -screen 0 1024x768x24 -ac +extension GLX +render -noreset &> xvfb.log &"
  - "export DISPLAY=:1"
  - pip install setuptools
```

4. После завершения всех приготовлений начинаем тестирование

```
script:
  python3 -m pytest
```

5. `Travis CI` по умолчанию уведомляет автора коммита, требуется лишь указать ему делать это как при удачных сборках, так и при неудачных

```
notifications:
  email:
    on_success: always
    on_failure: always
```

Также можно вручную указать, на какую почту должны приходить уведомления (пример из личного проекта):

```
notifications:
  email:
    recipients:
      - eaglemango@gmail.com
    on_success: always
    on_failure: always 
```

6. Загрузка пакета на `PyPI`

```
deploy:
   provider: pypi
   user: eaglemango
   password: "lol kek cheburek"
```

## Возникшие проблемы

Как было сказано выше, конфиг очень много раз изменялся. Это было связано с тем, что возникли трудности с запуском графических тестов на виртуальной машине. В теории, можно создать виртуальный монитор, но никакими правдами и неправдами это сделать не удалось. Возможно, дело в графической библиотеке, которую мы используем (`arcade.py`), однако было уже поздно её менять, поскольку на момент интеграции с `Travis CI`, было проделано много работы.

В отчаянии я обратился к автору библиотеки. Как оказалось, он тоже никак не смог подружить своё творение с `Travis CI`, поэтому после того, как у него не прошла тесты сотня коммитов, он просто убрал тесты с графикой.

![Ответ разаботчика](developer-answer.png)
